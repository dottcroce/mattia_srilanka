<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8"/>
<title>Trincomalee</title>
<link href="../style.css" rel="stylesheet"/>
<style>
    .top-section {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: wrap;
      margin: 20px auto;
      max-width: 1000px;
      gap: 30px;
    }
    .foto-localita {
      width: 400px;
      height: 250px;
      object-fit: cover;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .descrizione {
      flex: 1;
      background: #fff8dc;
      border: 2px dashed #cba135;
      padding: 20px;
      border-radius: 10px;
      font-size: 1.1em;
      font-family: 'Comic Sans MS', cursive;
      color: #444;
      line-height: 1.5em;
    }
    .diario-container {
      width: 80%;
      max-width: 700px;
      background: #fff8dc;
      border: 3px double #cba135;
      border-radius: 15px;
      padding: 20px;
      margin: 2em auto;
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      background-image: repeating-linear-gradient(
        to bottom,
        #fff8dc,
        #fff8dc 29px,
        #e0d8b0 30px
      );
    }
    textarea {
      width: 100%;
      height: 300px;
      font-family: 'Comic Sans MS', cursive;
      font-size: 1.1em;
      background: transparent;
      border: none;
      outline: none;
      resize: none;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      font-family: 'Comic Sans MS', cursive;
      background-color: #ffcb77;
      border: 2px solid #e07a5f;
      border-radius: 8px;
      cursor: pointer;
    }
</style>
<style>
    .header-location {
      position: relative;
      background-color: #ffcb77;
      color: #3d405b;
      padding: 1em 0.5em;
      margin: 0;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      font-family: 'Comic Sans MS', cursive;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .header-location .date-box {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      background-color: #ffe599;
      color: #d62828;
      padding: 4px 10px;
      border: 2px dashed #d62828;
      border-radius: 8px;
      font-weight: bold;
      font-size: 1em;
      white-space: nowrap;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }
    .header-location .header-content {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
    .header-location h1 {
      margin: 0;
      font-size: 2em;
      display: flex;
      align-items: center;
      gap: 0.3em;
    }
    .header-location h1 .icon {
      font-size: 0.8em;
    }
    .header-location input[type="checkbox"] {
      width: 1.2em;
      height: 1.2em;
      cursor: pointer;
    }
</style>
</head>
<body style="background-color:#fffde7;">
<div class="header-location">
  <div class="date-box">16–18 agosto</div>
  <div class="header-content">
    <input type="checkbox" id="visit-checkbox" />
    <h1>Trincomalee <span class="icon">⚓</span></h1>
  </div>
</div>

<div class="top-section">
  <img alt="Foto di Trincomalee" class="foto-localita" src="../img/localita/trincomalee.jpg"/>
  <div class="descrizione">
    Trincomalee si trova sulla costa nord-orientale dello <strong>Sri Lanka</strong>, a circa 240 km da Colombo. È famosa per il suo porto naturale poco profondo, uno dei più grandi al mondo.
    <br/><br/><strong>ALBERGO:</strong> Trinco Blue by Cinnamon
  </div>
</div>

<div class="diario-container">
  <div class="stars">
    <span class="star">★</span>
    <span class="star">★</span>
    <span class="star">★</span>
    <span class="star">★</span>
    <span class="star">★</span>
  </div>
  <textarea id="diario" placeholder="Scrivi qui i tuoi pensieri..." rows="10"></textarea>
  <div style="text-align:center; margin-top: 1em;">
    <button onclick="salva()">Salva</button>
    <button onclick="tornaHome()">Home</button>
  </div>
</div>

<script>
(function() {
  const diaryKey = 'diario_trincomalee';
  const ratingKey = 'rating_trincomalee';
  const visitKey = 'visit-trincomalee';
  const diario = document.getElementById('diario');
  let lastSavedValue = localStorage.getItem(diaryKey) || '';
  diario.value = lastSavedValue;
  let hasUnsavedChanges = false;
  diario.addEventListener('input', () => {
    hasUnsavedChanges = diario.value !== lastSavedValue;
  });
  window.addEventListener('beforeunload', (e) => {
    if (hasUnsavedChanges) {
      e.preventDefault();
      e.returnValue = '';
    }
  });
  window.salva = function salva() {
    localStorage.setItem(diaryKey, diario.value);
    lastSavedValue = diario.value;
    hasUnsavedChanges = false;
    alert('Pensieri salvati!');
  };
  window.tornaHome = function tornaHome() {
    if (hasUnsavedChanges) {
      if (!confirm('Non hai salvato le modifiche. Vuoi davvero uscire?')) return;
    }
    window.location.href = '../index.html';
  };
  document.addEventListener('DOMContentLoaded', () => {
    const stars = document.querySelectorAll('.stars .star');
    let currentRating = parseInt(localStorage.getItem(ratingKey)) || 0;
    const updateStars = () => {
      stars.forEach((star, idx) => {
        if (idx < currentRating) {
          star.classList.add('selected');
        } else {
          star.classList.remove('selected');
        }
      });
    };
    updateStars();
    stars.forEach((star, idx) => {
      star.addEventListener('click', () => {
        currentRating = idx + 1;
        localStorage.setItem(ratingKey, String(currentRating));
        updateStars();
      });
    });
    const visitCheckbox = document.getElementById('visit-checkbox');
    visitCheckbox.checked = localStorage.getItem(visitKey) === 'true';
    visitCheckbox.addEventListener('change', () => {
      localStorage.setItem(visitKey, visitCheckbox.checked.toString());
    });
  });
})();
</script>
</body>
</html>
